

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4. How to get the charge and magnetic moment on each atom? &mdash; theo-electrocatalysis 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Molecular Dynamics" href="../molecular-dynamics/index.html" />
    <link rel="prev" title="3. How to calculate the DOS and PDOS for the system?" href="dos-pdos.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> theo-electrocatalysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Welcome to the world of atomic simulation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../building-structure/index.html">How to build the chemical structures?</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Density Functional Theory</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dft-energy.html">1. How to calculate the energy and do geometric relaxation on a chemical system?</a></li>
<li class="toctree-l3"><a class="reference internal" href="vib-freq-analysis.html">2. How to calculate the vibrational frequencies?</a></li>
<li class="toctree-l3"><a class="reference internal" href="dos-pdos.html">3. How to calculate the DOS and PDOS for the system?</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4. How to get the charge and magnetic moment on each atom?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/index.html">Molecular Dynamics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../mean-field-theory/index.html">Welcome to the world of mean-field theory simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../macroscopic-simulation/index.html">Welcome to the world of macroscopic simulation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">theo-electrocatalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Welcome to the world of atomic simulation</a> &raquo;</li>
        
          <li><a href="index.html">Density Functional Theory</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>How to get the charge and magnetic moment on each atom?</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/atomic-simulation/DFT/dft-u-charge-magnetic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-get-the-charge-and-magnetic-moment-on-each-atom">
<h1><span class="section-number">4. </span>How to get the charge and magnetic moment on each atom?<a class="headerlink" href="#how-to-get-the-charge-and-magnetic-moment-on-each-atom" title="Permalink to this headline">Â¶</a></h1>
<p>It has already been shown in (1) <a class="reference internal" href="dft-energy.html#how-to-calculate-the-energy-and-do-geometric-relaxation-on-a-chemical-system"><span class="std std-ref">How to calculate the energy and do geometric relaxation on a chemical system?</span></a> and (2) <a class="reference internal" href="dos-pdos.html#how-to-calculate-the-dos-and-pdos-for-the-system"><span class="std std-ref">How to calculate the DOS and PDOS for the system?</span></a> how to get the energy and (projected) density of states, which can be very useful in explaining the experimental trends or do mechanistic analysis. But sometimes we want to have more information about the system, for example, for magnetic system, we would like to know the distribution of magnetic moments inside the material, and we also want to know the exact charge on different atoms. For doing this we need more input parameters to finely controlled the DFT code.</p>
<p><strong>Quantum Espresso</strong></p>
<p>In Quantum Espresso, we can do this by adding (1) U parameter and (2) spin polarized simulation, which means we need to add the following parameters to our <code class="code docutils literal notranslate"><span class="pre">INP_PWSCF</span></code> file mentioned in <a class="reference internal" href="dft-energy.html#how-to-calculate-the-energy-and-do-geometric-relaxation-on-a-chemical-system"><span class="std std-ref">How to calculate the energy and do geometric relaxation on a chemical system?</span></a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># for DFT+U settings</span>
<span class="nv">lda_plus_u</span> <span class="o">=</span> .true.
hubbard_u<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="o">=</span> <span class="m">5</span>.0

<span class="c1"># for spin-polarization settings</span>
<span class="nv">nspin</span> <span class="o">=</span> <span class="m">2</span>
<span class="nv">tot_magnetization</span> <span class="o">=</span> <span class="c1">#some number</span>
starting_magnetization<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="o">=</span> <span class="m">0</span>.1
starting_ns_eigenvalue<span class="o">(</span><span class="m">1</span>, <span class="m">1</span>, <span class="m">1</span><span class="o">)</span> <span class="o">=</span> <span class="m">1</span>.0 <span class="c1"># this is for finely tuning the initial magnetization, the first number is the index of the orbital (e.g. for d band it ranges from 1 to 5), the second number is the index of spin (1 or 2), the third number is the index of the atom (see that in ATOMIC SPECIES in the input file).</span>

<span class="c1"># if you want to constrain the magnetic moment</span>
<span class="p">&amp;</span>ELECTRONS
<span class="nv">mixing_fixed_ns</span> <span class="o">=</span> <span class="m">10</span> <span class="c1"># In 10 SCF steps, the magnetic moment will be the same as mentioned in starting_ns_eigenvalue.</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../molecular-dynamics/index.html" class="btn btn-neutral float-right" title="Molecular Dynamics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="dos-pdos.html" class="btn btn-neutral float-left" title="3. How to calculate the DOS and PDOS for the system?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Zhengda He.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>